<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Lab Reactor ‚Äì Acid, Base & Salt</title>
<style>
  * { box-sizing: border-box; font-family: Arial, sans-serif; }
  body {
    margin: 0;
    background: linear-gradient(135deg, #a855f7, #22c55e);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }

  .screen {
    width: 900px;
    height: 560px;
    background: #f8fafc;
    border-radius: 16px;
    padding: 20px;
    display: none;
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
  }
  .active { display: block; }

  h1, h2 { text-align: center; }

  button {
    padding: 12px 30px;
    font-size: 18px;
    border: none;
    border-radius: 8px;
    background: #7c3aed;
    color: white;
    cursor: pointer;
  }
  button:hover { background: #6d28d9; }

  .center { text-align: center; margin-top: 40px; }

  .hud {
    display: flex;
    justify-content: space-between;
    font-size: 18px;
    margin-bottom: 10px;
  }

  .stars { color: gold; }

  #instruction {
    text-align: center;
    font-size: 22px;
    font-weight: bold;
    margin-bottom: 10px;
  }

  #labArea {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-top: 20px;
  }

  .beaker {
    background: #e5e7eb;
    border-radius: 12px;
    padding: 20px;
    height: 120px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    user-select: none;
  }

  .acid { background: #fecaca; }
  .base { background: #bbf7d0; }
  .salt { background: #bfdbfe; }

  .correct { outline: 4px solid #22c55e; }
  .wrong { outline: 4px solid #ef4444; }
</style>
</head>
<body>

<!-- START SCREEN -->
<div id="startScreen" class="screen active">
  <h1>‚öóÔ∏è Lab Reactor</h1>
  <p style="text-align:center; font-size:18px;">
    Activate the correct substances in the lab to form neutral products!
  </p>
  <div class="center">
    <button onclick="startGame()">Start Experiment</button>
  </div>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen" class="screen">
  <div class="hud">
    <div>Score: <span id="score">0</span></div>
    <div>Level: <span id="level">1</span></div>
    <div>Time: <span id="time">60</span>s</div>
    <div class="stars" id="stars">‚≠ê</div>
  </div>

  <div id="instruction"></div>

  <div id="labArea"></div>
</div>

<!-- END SCREEN -->
<div id="endScreen" class="screen">
  <h1>‚è±Ô∏è Experiment Over</h1>
  <h2>Score: <span id="finalScore"></span></h2>
  <h3>Stars: <span id="finalStars"></span></h3>
  <div class="center">
    <button onclick="restartGame()">Try Again</button>
  </div>
</div>

<!-- FINISH SCREEN -->
<div id="finishScreen" class="screen">
  <h1>üèÜ Master Chemist!</h1>
  <h2>All reactions completed successfully</h2>
  <h3>Final Score: <span id="finishScore"></span></h3>
  <h3>Stars Earned: <span id="finishStars"></span></h3>
  <div class="center">
    <button onclick="restartGame()">Play Again</button>
  </div>
</div>

<script>
  const screens = {
    start: document.getElementById('startScreen'),
    game: document.getElementById('gameScreen'),
    end: document.getElementById('endScreen'),
    finish: document.getElementById('finishScreen')
  };

  const scoreEl = document.getElementById('score');
  const levelEl = document.getElementById('level');
  const timeEl = document.getElementById('time');
  const starsEl = document.getElementById('stars');
  const instructionEl = document.getElementById('instruction');
  const labArea = document.getElementById('labArea');

  let score = 0;
  let level = 1;
  let stars = 1;
  let timeLeft = 60;
  let timer;

  const levels = [
    { target: 'acid', instruction: 'Activate all ACIDS' },
    { target: 'base', instruction: 'Activate all BASES' },
    { target: 'salt', instruction: 'Activate all SALTS' },
    { target: 'neutral', instruction: 'Activate ACID then BASE to form SALT' }
  ];

  function startGame() {
    switchScreen('game');
    resetGame();
    timer = setInterval(updateTimer, 1000);
  }

  function resetGame() {
    score = 0;
    level = 1;
    stars = 1;
    timeLeft = 60;
    loadLevel();
    updateHUD();
  }

  function updateHUD() {
    scoreEl.textContent = score;
    levelEl.textContent = level;
    timeEl.textContent = timeLeft;
    starsEl.textContent = '‚≠ê'.repeat(stars);
  }

  function loadLevel() {
    labArea.innerHTML = '';
    const data = levels[level - 1];
    instructionEl.textContent = data.instruction;

    const substances = ['acid', 'base', 'salt'];

    const formulas = {
      acid: ['HCl', 'H2SO4'],
      base: ['NaOH', 'KOH'],
      salt: ['NaCl', 'KCl']
    };

    substances.sort(() => Math.random() - 0.5).forEach(type => {
      for (let i = 0; i < 2; i++) {
        const div = document.createElement('div');
        div.className = `beaker ${type}`;
        div.textContent = formulas[type][i];
        div.dataset.type = type;

        div.addEventListener('click', () => {
          if (type === data.target) {
            div.classList.add('correct');
            score += 10;
          } else {
            div.classList.add('wrong');
            score -= 5;
            setTimeout(() => div.classList.remove('wrong'), 500);
          }
          updateHUD();
          checkCompletion(data.target);
        });

        labArea.appendChild(div);
      }
    });
  }

  function checkCompletion(target) {
    const remaining = [...document.querySelectorAll(`.beaker.${target}:not(.correct)`)].length;
    if (remaining === 0) nextLevel();
  }

  function nextLevel() {
    stars = Math.min(3, stars + 1);
    level++;
    if (level > levels.length) finishGame();
    else loadLevel();
    updateHUD();
  }

  function updateTimer() {
    timeLeft--;
    updateHUD();
    if (timeLeft <= 0) endGame();
  }

  function endGame() {
    clearInterval(timer);
    switchScreen('end');
    document.getElementById('finalScore').textContent = score;
    document.getElementById('finalStars').textContent = '‚≠ê'.repeat(stars);
  }

  function finishGame() {
    clearInterval(timer);
    switchScreen('finish');
    document.getElementById('finishScore').textContent = score;
    document.getElementById('finishStars').textContent = '‚≠ê'.repeat(stars);
  }

  function restartGame() {
    switchScreen('start');
  }

  function switchScreen(name) {
    Object.values(screens).forEach(s => s.classList.remove('active'));
    screens[name].classList.add('active');
  }
</script>

</body>
</html>